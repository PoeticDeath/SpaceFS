name: SpaceFS

on:
  push:
    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]

permissions:
  contents: read

jobs:
  linux-build:
  
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4
    - name: Set up Python 3.12
      uses: actions/setup-python@v5
      with:
        python-version: "3.12"
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install wheel
        pip install pyinstaller
        pip install https://github.com/PoeticDeath/refuse/archive/refs/heads/master.zip
    - name: Compile SpaceFS
      run: |
        pyinstaller -F FuseTran.py
        mv /home/runner/work/SpaceFS/SpaceFS/dist/FuseTran /home/runner/work/SpaceFS/SpaceFS/dist/SpaceFS
    - name: Upload SpaceFS
      uses: actions/upload-artifact@v4
      with:
        name: SpaceFS
        path: /home/runner/work/SpaceFS/SpaceFS/dist/SpaceFS

  win-build-test-FUSE:

    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v4
    - name: Set up Python 3.12
      uses: actions/setup-python@v5
      with:
        python-version: "3.12"
    - name: Install dependencies
      run: |
        choco install winfsp -y --version=2.0.23075
        python -m pip install --upgrade pip
        pip install wheel
        pip install pyinstaller wmi
        pip install https://github.com/PoeticDeath/refuse/archive/refs/heads/master.zip
    - name: Download winfsp-test
      uses: engineerd/configurator@v0.0.10
      with:
          name: winfsp-tests-x64.exe
          url: https://github.com/winfsp/winfsp/releases/download/v2.0/winfsp-tests-2.0.23075.zip
          pathInArchive: winfsp-tests-x64.exe
    - name: Create Drive File and Compile & Start SpaceFS
      run: |
        fsutil file createnew D:\SpaceFS.bin 1073741824
        pyinstaller -F FuseTran.py
        copy StartFUSE.bat C:\Users\runneradmin\runneradmin\configurator\bin\StartFUSE.bat
        copy dist/FuseTran.exe C:\Users\runneradmin\runneradmin\configurator\bin\FUSESpaceFS.exe
        copy "C:\Program Files (x86)\WinFsp\bin\winfsp-x64.dll" C:\Users\runneradmin\runneradmin\configurator\bin\winfsp-x64.dll
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: Upload FUSESpaceFS
      uses: actions/upload-artifact@v4
      with:
        name: FUSESpaceFS
        path: C:\Users\runneradmin\runneradmin\configurator\bin\FUSESpaceFS.exe
    - name: create_test
      id: fuse_create_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient create_test
    - name: Format 1
      if: failure() && steps.fuse_create_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_fileattr_test
      id: fuse_create_fileattr_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient create_fileattr_test
    - name: Format 2
      if: failure() && steps.fuse_create_fileattr_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_readonlydir_test
      id: fuse_create_readonlydir_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient create_readonlydir_test
    - name: Format 3
      if: failure() && steps.fuse_create_readonlydir_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_related_test
      id: fuse_create_related_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient create_related_test
    - name: Format 4
      if: failure() && steps.fuse_create_related_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_sd_test
      id: fuse_create_sd_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient create_sd_test
    - name: Format 5
      if: failure() && steps.fuse_create_sd_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_backup_test
      id: fuse_create_backup_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient create_backup_test
    - name: Format 6
      if: failure() && steps.fuse_create_backup_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_restore_test
      id: fuse_create_restore_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient create_restore_test
    - name: Format 7
      if: failure() && steps.fuse_create_restore_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_share_test
      id: fuse_create_share_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient create_share_test
    - name: Format 8
      if: failure() && steps.fuse_create_share_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_curdir_test
      id: fuse_create_curdir_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient create_curdir_test
    - name: Format 9
      if: failure() && steps.fuse_create_curdir_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_namelen_test
      id: fuse_create_namelen_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient create_namelen_test
    - name: Format 10
      if: failure() && steps.fuse_create_namelen_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: getfileinfo_test
      id: fuse_getfileinfo_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient getfileinfo_test
    - name: Format 11
      if: failure() && steps.fuse_getfileinfo_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: setfileinfo_test
      id: fuse_setfileinfo_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient setfileinfo_test
    - name: Format 12
      if: failure() && steps.fuse_setfileinfo_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: delete_test
      id: fuse_delete_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient delete_test
    - name: Format 13
      if: failure() && steps.fuse_delete_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: delete_access_test
      id: fuse_delete_access_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient delete_access_test
    - name: Format 14
      if: failure() && steps.fuse_delete_access_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: delete_pending_test
      id: fuse_delete_pending_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient delete_pending_test
    - name: Format 15
      if: failure() && steps.fuse_delete_pending_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: delete_mmap_test
      id: fuse_delete_mmap_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient delete_mmap_test
    - name: Format 16
      if: failure() && steps.fuse_delete_mmap_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: delete_standby_test
      id: fuse_delete_standby_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient delete_standby_test
    - name: Format 17
      if: failure() && steps.fuse_delete_standby_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: delete_ex_test
      id: fuse_delete_ex_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient delete_ex_test
    - name: Format 18
      if: failure() && steps.fuse_delete_ex_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_test
      id: fuse_rename_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rename_test
    - name: Format 19
      if: failure() && steps.fuse_rename_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_backslash_test
      id: fuse_rename_backslash_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rename_backslash_test
    - name: Format 20
      if: failure() && steps.fuse_rename_backslash_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_open_test
      id: fuse_rename_open_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rename_open_test
    - name: Format 21
      if: failure() && steps.fuse_rename_open_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_caseins_test
      id: fuse_rename_caseins_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rename_caseins_test
    - name: Format 22
      if: failure() && steps.fuse_rename_caseins_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_flipflop_test
      id: fuse_rename_flipflop_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rename_flipflop_test
    - name: Format 23
      if: failure() && steps.fuse_rename_flipflop_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_mmap_test
      id: fuse_rename_mmap_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rename_mmap_test
    - name: Format 24
      if: failure() && steps.fuse_rename_mmap_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_standby_test
      id: fuse_rename_standby_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rename_standby_test
    - name: Format 25
      if: failure() && steps.fuse_rename_standby_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_ex_test
      id: fuse_rename_ex_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rename_ex_test
    - name: Format 26
      if: failure() && steps.fuse_rename_ex_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: getvolinfo_test
      id: fuse_getvolinfo_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient getvolinfo_test
    - name: Format 27
      if: failure() && steps.fuse_getvolinfo_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: setvolinfo_test
      id: fuse_setvolinfo_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient setvolinfo_test
    - name: Format 28
      if: failure() && steps.fuse_setvolinfo_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: getsecurity_test
      id: fuse_getsecurity_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient getsecurity_test
    - name: Format 29
      if: failure() && steps.fuse_getsecurity_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_noncached_test
      id: fuse_rdwr_noncached_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rdwr_noncached_test
    - name: Format 30
      if: failure() && steps.fuse_rdwr_noncached_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_noncached_overlapped_test
      id: fuse_rdwr_noncached_overlapped_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rdwr_noncached_overlapped_test
    - name: Format 31
      if: failure() && steps.fuse_rdwr_noncached_overlapped_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_cached_test
      id: fuse_rdwr_cached_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rdwr_cached_test
    - name: Format 32
      if: failure() && steps.fuse_rdwr_cached_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_cached_append_test
      id: fuse_rdwr_cached_append_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rdwr_cached_append_test
    - name: Format 33
      if: failure() && steps.fuse_rdwr_cached_append_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_cached_overlapped_test
      id: fuse_rdwr_cached_overlapped_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rdwr_cached_overlapped_test
    - name: Format 34
      if: failure() && steps.fuse_rdwr_cached_overlapped_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_writethru_test
      id: fuse_rdwr_writethru_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rdwr_writethru_test
    - name: Format 35
      if: failure() && steps.fuse_rdwr_writethru_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_writethru_append_test
      id: fuse_rdwr_writethru_append_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rdwr_writethru_append_test
    - name: Format 36
      if: failure() && steps.fuse_rdwr_writethru_append_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_writethru_overlapped_test
      id: fuse_rdwr_writethru_overlapped_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rdwr_writethru_overlapped_test
    - name: Format 37
      if: failure() && steps.fuse_rdwr_writethru_overlapped_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_mmap_test
      id: fuse_rdwr_mmap_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rdwr_mmap_test
    - name: Format 38
      if: failure() && steps.fuse_rdwr_mmap_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_mixed_test
      id: fuse_rdwr_mixed_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient rdwr_mixed_test
    - name: Format 39
      if: failure() && steps.fuse_rdwr_mixed_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: flush_test
      id: fuse_flush_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient flush_test
    - name: Format 40
      if: failure() && steps.fuse_flush_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: flush_volume_test
      id: fuse_flush_volume_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient flush_volume_test
    - name: Format 41
      if: failure() && steps.fuse_flush_volume_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: lock_noncached_test
      id: fuse_lock_noncached_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient lock_noncached_test
    - name: Format 42
      if: failure() && steps.fuse_lock_noncached_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: lock_noncached_overlapped_test
      id: fuse_lock_noncached_overlapped_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient lock_noncached_overlapped_test
    - name: Format 43
      if: failure() && steps.fuse_lock_noncached_overlapped_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: lock_cached_test
      id: fuse_lock_cached_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient lock_cached_test
    - name: Format 44
      if: failure() && steps.fuse_lock_cached_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: lock_cached_overlapped_test
      id: fuse_lock_cached_overlapped_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient lock_cached_overlapped_test
    - name: Format 45
      if: failure() && steps.fuse_lock_cached_overlapped_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: querydir_test
      id: fuse_querydir_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient querydir_test
    - name: Format 46
      if: failure() && steps.fuse_querydir_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: querydir_expire_cache_test
      id: fuse_querydir_expire_cache_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient querydir_expire_cache_test
    - name: Format 47
      if: failure() && steps.fuse_querydir_expire_cache_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: querydir_buffer_overflow_test
      id: fuse_querydir_buffer_overflow_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient querydir_buffer_overflow_test
    - name: Format 48
      if: failure() && steps.fuse_querydir_buffer_overflow_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: querydir_namelen_test
      id: fuse_querydir_namelen_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient querydir_namelen_test
    - name: Format 49
      if: failure() && steps.fuse_querydir_namelen_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: dirnotify_test
      id: fuse_dirnotify_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient dirnotify_test
    - name: Format 50
      if: failure() && steps.fuse_dirnotify_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: exec_test
      id: fuse_exec_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient exec_test
    - name: Format 51
      if: failure() && steps.fuse_exec_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: exec_delete_test
      id: fuse_exec_delete_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient exec_delete_test
    - name: Format 52
      if: failure() && steps.fuse_exec_delete_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: exec_rename_test
      id: fuse_exec_rename_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient exec_rename_test
    - name: Format 53
      if: failure() && steps.fuse_exec_rename_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: exec_rename_dir_test
      id: fuse_exec_rename_dir_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient exec_rename_dir_test
    - name: Format 54
      if: failure() && steps.fuse_exec_rename_dir_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: reparse_nfs_test
      id: fuse_reparse_nfs_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient reparse_nfs_test
    - name: Format 55
      if: failure() && steps.fuse_reparse_nfs_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: reparse_symlink_test
      id: fuse_reparse_symlink_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient reparse_symlink_test
    - name: Format 56
      if: failure() && steps.fuse_reparse_symlink_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: reparse_symlink_relative_test
      id: reparse_symlink_relative_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --fuse-external --resilient reparse_symlink_relative_test
    - name: Format 57
      if: failure() && steps.reparse_symlink_relative_test.outcome == 'failure'
      run: |
        taskkill /F /IM FUSESpaceFS.exe
        start StartFUSE.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
  
  win-build-test-WinFsp:

    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v4
    - name: Set up Python 3.12
      uses: actions/setup-python@v5
      with:
        python-version: "3.12"
    - name: Install dependencies
      run: |
        choco install winfsp -y --version=2.0.23075
        python -m pip install --upgrade pip
        pip install wheel
        pip install pyinstaller==5.13.2 wmi
        pip install https://github.com/PoeticDeath/winfspy/archive/refs/heads/master.zip
    - name: Download winfsp-test
      uses: engineerd/configurator@v0.0.10
      with:
          name: winfsp-tests-x64.exe
          url: https://github.com/winfsp/winfsp/releases/download/v2.0/winfsp-tests-2.0.23075.zip
          pathInArchive: winfsp-tests-x64.exe
    - name: Create Drive File and Compile & Start SpaceFS
      run: |
        fsutil file createnew D:\SpaceFS.bin 1073741824
        pyinstaller -F WinFspTran.py --hidden-import=_cffi_backend
        copy StartWinFsp.bat C:\Users\runneradmin\runneradmin\configurator\bin\StartWinFsp.bat
        copy dist/WinFspTran.exe C:\Users\runneradmin\runneradmin\configurator\bin\WinFspSpaceFS.exe
        copy "C:\Program Files (x86)\WinFsp\bin\winfsp-x64.dll" C:\Users\runneradmin\runneradmin\configurator\bin\winfsp-x64.dll
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: Upload WinFspSpaceFS
      uses: actions/upload-artifact@v4
      with:
        name: WinFspSpaceFS
        path: C:\Users\runneradmin\runneradmin\configurator\bin\WinFspSpaceFS.exe
    - name: create_test
      id: create_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient create_test
    - name: Format 1
      if: failure() && steps.create_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_fileattr_test
      id: create_fileattr_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient create_fileattr_test
    - name: Format 2
      if: failure() && steps.create_fileattr_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_readonlydir_test
      id: create_readonlydir_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient create_readonlydir_test
    - name: Format 3
      if: failure() && steps.create_readonlydir_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_related_test
      id: create_related_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient create_related_test
    - name: Format 4
      if: failure() && steps.create_related_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_allocation_test
      id: create_allocation_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient create_allocation_test
    - name: Format 5
      if: failure() && steps.create_allocation_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_sd_test
      id: create_sd_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient create_sd_test
    - name: Format 6
      if: failure() && steps.create_sd_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_notraverse_test
      id: create_notraverse_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient create_notraverse_test
    - name: Format 7
      if: failure() && steps.create_notraverse_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_backup_test
      id: create_backup_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient create_backup_test
    - name: Format 8
      if: failure() && steps.create_backup_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_restore_test
      id: create_restore_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient create_restore_test
    - name: Format 9
      if: failure() && steps.create_restore_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_share_test
      id: create_share_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient create_share_test
    - name: Format 10
      if: failure() && steps.create_share_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_curdir_test
      id: create_curdir_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient create_curdir_test
    - name: Format 11
      if: failure() && steps.create_curdir_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: create_namelen_test
      id: create_namelen_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient create_namelen_test
    - name: Format 12
      if: failure() && steps.create_namelen_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: getfileattr_test
      id: getfileattr_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient getfileattr_test
    - name: Format 13
      if: failure() && steps.getfileattr_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: getfileinfo_test
      id: getfileinfo_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient getfileinfo_test
    - name: Format 14
      if: failure() && steps.getfileinfo_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: getfileinfo_name_test
      id: getfileinfo_name_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient getfileinfo_name_test
    - name: Format 15
      if: failure() && steps.getfileinfo_name_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: setfileinfo_test
      id: setfileinfo_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient setfileinfo_test
    - name: Format 16
      if: failure() && steps.setfileinfo_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: delete_test
      id: delete_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient delete_test
    - name: Format 17
      if: failure() && steps.delete_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: delete_access_test
      id: delete_access_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient delete_access_test
    - name: Format 18
      if: failure() && steps.delete_access_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: delete_pending_test
      id: delete_pending_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient delete_pending_test
    - name: Format 19
      if: failure() && steps.delete_pending_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: delete_mmap_test
      id: delete_mmap_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient delete_mmap_test
    - name: Format 20
      if: failure() && steps.delete_mmap_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: delete_standby_test
      id: delete_standby_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient delete_standby_test
    - name: Format 21
      if: failure() && steps.delete_standby_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: delete_ex_test
      id: delete_ex_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient delete_ex_test
    - name: Format 22
      if: failure() && steps.delete_ex_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_test
      id: rename_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rename_test
    - name: Format 23
      if: failure() && steps.rename_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_backslash_test
      id: rename_backslash_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rename_backslash_test
    - name: Format 24
      if: failure() && steps.rename_backslash_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_open_test
      id: rename_open_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rename_open_test
    - name: Format 25
      if: failure() && steps.rename_open_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_caseins_test
      id: rename_caseins_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rename_caseins_test
    - name: Format 26
      if: failure() && steps.rename_caseins_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_flipflop_test
      id: rename_flipflop_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rename_flipflop_test
    - name: Format 27
      if: failure() && steps.rename_flipflop_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_mmap_test
      id: rename_mmap_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rename_mmap_test
    - name: Format 28
      if: failure() && steps.rename_mmap_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_standby_test
      id: rename_standby_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rename_standby_test
    - name: Format 29
      if: failure() && steps.rename_standby_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rename_ex_test
      id: rename_ex_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rename_ex_test
    - name: Format 30
      if: failure() && steps.rename_ex_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: getvolinfo_test
      id: getvolinfo_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient getvolinfo_test
    - name: Format 31
      if: failure() && steps.getvolinfo_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: setvolinfo_test
      id: setvolinfo_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient setvolinfo_test
    - name: Format 32
      if: failure() && steps.setvolinfo_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: getsecurity_test
      id: getsecurity_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient getsecurity_test
    - name: Format 33
      if: failure() && steps.getsecurity_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: setsecurity_test
      id: setsecurity_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient setsecurity_test
    - name: Format 34
      if: failure() && steps.setsecurity_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_noncached_test
      id: rdwr_noncached_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rdwr_noncached_test
    - name: Format 35
      if: failure() && steps.rdwr_noncached_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_noncached_overlapped_test
      id: rdwr_noncached_overlapped_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rdwr_noncached_overlapped_test
    - name: Format 36
      if: failure() && steps.rdwr_noncached_overlapped_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_cached_test
      id: rdwr_cached_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rdwr_cached_test
    - name: Format 37
      if: failure() && steps.rdwr_cached_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_cached_append_test
      id: rdwr_cached_append_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rdwr_cached_append_test
    - name: Format 38
      if: failure() && steps.rdwr_cached_append_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_cached_overlapped_test
      id: rdwr_cached_overlapped_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rdwr_cached_overlapped_test
    - name: Format 39
      if: failure() && steps.rdwr_cached_overlapped_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_writethru_test
      id: rdwr_writethru_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rdwr_writethru_test
    - name: Format 40
      if: failure() && steps.rdwr_writethru_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_writethru_append_test
      id: rdwr_writethru_append_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rdwr_writethru_append_test
    - name: Format 41
      if: failure() && steps.rdwr_writethru_append_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_writethru_overlapped_test
      id: rdwr_writethru_overlapped_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rdwr_writethru_overlapped_test
    - name: Format 42
      if: failure() && steps.rdwr_writethru_overlapped_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_mmap_test
      id: rdwr_mmap_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rdwr_mmap_test
    - name: Format 43
      if: failure() && steps.rdwr_mmap_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: rdwr_mixed_test
      id: rdwr_mixed_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient rdwr_mixed_test
    - name: Format 44
      if: failure() && steps.rdwr_mixed_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: flush_test
      id: flush_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient flush_test
    - name: Format 45
      if: failure() && steps.flush_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: flush_volume_test
      id: flush_volume_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient flush_volume_test
    - name: Format 46
      if: failure() && steps.flush_volume_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: lock_noncached_test
      id: lock_noncached_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient lock_noncached_test
    - name: Format 47
      if: failure() && steps.lock_noncached_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: lock_noncached_overlapped_test
      id: lock_noncached_overlapped_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient lock_noncached_overlapped_test
    - name: Format 48
      if: failure() && steps.lock_noncached_overlapped_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: lock_cached_test
      id: lock_cached_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient lock_cached_test
    - name: Format 49
      if: failure() && steps.lock_cached_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: lock_cached_overlapped_test
      id: lock_cached_overlapped_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient lock_cached_overlapped_test
    - name: Format 50
      if: failure() && steps.lock_cached_overlapped_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: querydir_test
      id: querydir_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient querydir_test
    - name: Format 51
      if: failure() && steps.querydir_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: querydir_expire_cache_test
      id: querydir_expire_cache_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient querydir_expire_cache_test
    - name: Format 52
      if: failure() && steps.querydir_expire_cache_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: querydir_buffer_overflow_test
      id: querydir_buffer_overflow_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient querydir_buffer_overflow_test
    - name: Format 53
      if: failure() && steps.querydir_buffer_overflow_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: querydir_namelen_test
      id: querydir_namelen_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient querydir_namelen_test
    - name: Format 54
      if: failure() && steps.querydir_namelen_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: dirnotify_test
      id: dirnotify_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient dirnotify_test
    - name: Format 55
      if: failure() && steps.dirnotify_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: exec_test
      id: exec_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient exec_test
    - name: Format 56
      if: failure() && steps.exec_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: exec_delete_test
      id: exec_delete_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient exec_delete_test
    - name: Format 57
      if: failure() && steps.exec_delete_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: exec_rename_test
      id: exec_rename_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient exec_rename_test
    - name: Format 58
      if: failure() && steps.exec_rename_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: exec_rename_dir_test
      id: exec_rename_dir_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient exec_rename_dir_test
    - name: Format 59
      if: failure() && steps.exec_rename_dir_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: reparse_guid_test
      id: reparse_guid_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient reparse_guid_test
    - name: Format 60
      if: failure() && steps.reparse_guid_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: reparse_nfs_test
      id: reparse_nfs_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient reparse_nfs_test
    - name: Format 61
      if: failure() && steps.reparse_nfs_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: reparse_symlink_test
      id: reparse_symlink_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient reparse_symlink_test
    - name: Format 62
      if: failure() && steps.reparse_symlink_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: reparse_symlink_relative_test
      id: reparse_symlink_relative_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient reparse_symlink_relative_test
    - name: Format 63
      if: failure() && steps.reparse_symlink_relative_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_create_test
      id: stream_create_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_create_test
    - name: Format 64
      if: failure() && steps.stream_create_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_create_overwrite_test
      id: stream_create_overwrite_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_create_overwrite_test
    - name: Format 65
      if: failure() && steps.stream_create_overwrite_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_create_related_test
      id: stream_create_related_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_create_related_test
    - name: Format 66
      if: failure() && steps.stream_create_related_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_create_sd_test
      id: stream_create_sd_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_create_sd_test
    - name: Format 67
      if: failure() && steps.stream_create_sd_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_create_share_test
      id: stream_create_share_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_create_share_test
    - name: Format 68
      if: failure() && steps.stream_create_share_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_getfileinfo_test
      id: stream_getfileinfo_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_getfileinfo_test
    - name: Format 69
      if: failure() && steps.stream_getfileinfo_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_setfileinfo_test
      id: stream_setfileinfo_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_setfileinfo_test
    - name: Format 70
      if: failure() && steps.stream_setfileinfo_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_delete_test
      id: stream_delete_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_delete_test
    - name: Format 71
      if: failure() && steps.stream_delete_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_delete_pending_test
      id: stream_delete_pending_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_delete_pending_test
    - name: Format 72
      if: failure() && steps.stream_delete_pending_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_rename_flipflop_test
      id: stream_rename_flipflop_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_rename_flipflop_test
    - name: Format 73
      if: failure() && steps.stream_rename_flipflop_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_getsecurity_test
      id: stream_getsecurity_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_getsecurity_test
    - name: Format 74
      if: failure() && steps.stream_getsecurity_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_setsecurity_test
      id: stream_setsecurity_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_setsecurity_test
    - name: Format 75
      if: failure() && steps.stream_setsecurity_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_getstreaminfo_test
      id: stream_getstreaminfo_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_getstreaminfo_test
    - name: Format 76
      if: failure() && steps.stream_getstreaminfo_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_getstreaminfo_expire_cache_test
      id: stream_getstreaminfo_expire_cache_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_getstreaminfo_expire_cache_test
    - name: Format 77
      if: failure() && steps.stream_getstreaminfo_expire_cache_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
    - name: stream_dirnotify_test
      id: stream_dirnotify_test
      working-directory: S:\
      if: success() || failure()
      run: |
        winfsp-tests-x64.exe --external --resilient stream_dirnotify_test
    - name: Format 78
      if: failure() && steps.stream_dirnotify_test.outcome == 'failure'
      run: |
        taskkill /F /IM WinFspSpaceFS.exe
        start StartWinFsp.bat
        python -c "from time import sleep; from os.path import isdir; [sleep(2) for i in range(10) if not isdir('S:')]"
